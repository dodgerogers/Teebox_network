<%= content_for :head do %>
	<!-- inits video player, loads related questions via ajax -->
	<%= javascript_include_tag "sublime.js", "playlist.js", "related_questions.js", defer: "defer" %>
<% end %>

<% meta_title(@decorator.title) %>
<% meta_keywords(@decorator.tags.map(&:name).join(", ")) %>
<% meta_description(@decorator.title) %>

<div class="row">
	<div class="span8">
		<div class="video-container">
			<%= render partial: "videos/playlist", locals: { videos: @decorator.videos } %>
		</div>
		<div id="question-box" data-id="<%= @decorator.id %>">
			<div class="question">
				<h3><%= @decorator.title.capitalize %></h3>		
				<div class="question-content">
					<%= simple_format(@decorator.body) %>
				</div>
				<div class="question-tags">
					<%= @decorator.question_tags %>
				</div>
				<div class="profile-info">
					<%= render partial: "votes/form", locals: { votes_count: "questions", object: @decorator, vote_path: method(:vote_question_path) } %> 
				    <%= profile_link_helper(@decorator) %>
					<div class="profile">
						<%= link_to "Edit", edit_question_path(@decorator) if can? :update, @decorator %>
						<%= link_to "Delete", @decorator, method: :delete, confirm: "Are you sure? You will lose any points associated with this question" if can? :destroy, @decorator %>
					</div>
				</div>
			</div>
			
			<section class="comments-area">
				<table class="table teebox-table" id="question_<%= @decorator.id %>">
					<%= render @decorator.comments.includes(:user) %>
				</table>
				<%= link_to "Add comment", "#", class: "comment-button" %>
				<%= render partial: "comments/form", locals: {commentable: @decorator} %>
			</section>
		</div>
		
		<div id='answers-count' class="<%= @decorator.answers_count > 0 ? 'answered' : 'unanswered' %>">
			<h3><%= pluralize(@decorator.answers_count, "Answer")  %></h3>
		</div>
		
		<section id="question-answers">
			<%= render @answers %>
		</section>
		
		<a href="#" id="answer-button" class="default submit">Answer question</a><br><br>
		<%= render partial: "answers/form", locals: { question_id: @decorator.id } %>
	</div>
	
	<aside class="span4">
		<div id="load-related">
			<!-- questions/related loaded here -->
			<%= render partial: "shared/loading", locals: { message: "related questions..." } %>
		</div>
		<div class="social-buttons">
			<p>Know someone who can help?</p>
			<p><%= social_links(request.original_url) %></p>
		</div>
		<p><%= link_to "Ask a question", videos_path %></p>
	</aside>
</div>